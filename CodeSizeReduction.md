# Code size reduction for JIT Value Specialization #

Most of our optimization passes lead to a decrease in the number of generated instructions and in the size of the generated machine code. We have measured this decrease based on the size of the last compilation of each function. This code size reduction was measured on 4 benchmarks suites - SunSpider 1.0, V8-V6, Kraken 1.1, and [JSBench](http://jsbench.cs.purdue.edu). The results from JSBench are shown per-script, while the others are shown per-suite. We have also measured the number of recompilations due to our optimization passes, as well as the total number of deoptimizations of specialized functions. These numbers are presented on the three tables below.

**PS: Parameter Specialization.**<br>
CP: Constant Propagation. <br>
LINV: Loop Inversion. <br>
DCE: Dead-Code Elimination. <br>
BCE: Array Bounds Check Elimination.<br>
<br>
<h2>Code size reduction</h2>
<table><thead><th> <b>SUITE/BENCHMARK</b> </th><th> <b>PS</b> </th><th> <b>CP</b> </th><th> <b>PS/CP</b> </th><th> <b>PS/DCEC</b> </th><th> <b>PS/LINV</b> </th><th> <b>PS/CP/DCEC</b> </th><th> <b>PS/CP/BCE</b> </th><th> <b>PS/CP/LINV</b> </th><th> <b>PS/CP/DCEC/BCE</b> </th><th> <b>PS/CP/LINV/DCEC/BCE</b> </th></thead><tbody>
<tr><td> facebook-chrome        </td><td> <font color='green'>0.8962</font> </td><td> <font color='red'>1.0005</font> </td><td> <font color='green'>0.8944</font> </td><td> <font color='green'>0.8962</font> </td><td> <font color='green'>0.8994</font> </td><td> <font color='green'>0.8675</font> </td><td> <font color='green'>0.8944</font> </td><td> <font color='green'>0.8976</font> </td><td> <font color='green'>0.8675</font> </td><td> <font color='green'>0.8707</font> </td></tr>
<tr><td> google-firefox         </td><td> <font color='green'>0.9470</font> </td><td> <font color='red'>1.0003</font> </td><td> <font color='green'>0.9421</font> </td><td> <font color='green'>0.9470</font> </td><td> <font color='green'>0.9470</font> </td><td> <font color='green'>0.8863</font> </td><td> <font color='green'>0.9421</font> </td><td> <font color='green'>0.9421</font> </td><td> <font color='green'>0.8863</font> </td><td> <font color='green'>0.8863</font> </td></tr>
<tr><td> twitter-webkit         </td><td> <font color='green'>0.9756</font> </td><td> <font color='red'>1.0013</font> </td><td> <font color='green'>0.9658</font> </td><td> <font color='green'>0.9756</font> </td><td> <font color='green'>0.9756</font> </td><td> <font color='green'>0.7787</font> </td><td> <font color='green'>0.9658</font> </td><td> <font color='green'>0.9658</font> </td><td> <font color='green'>0.7787</font> </td><td> <font color='green'>0.7787</font> </td></tr>
<tr><td> yahoo-firefox          </td><td> <font color='green'>0.9330</font> </td><td> <font color='red'>1.0021</font> </td><td> <font color='green'>0.9357</font> </td><td> <font color='green'>0.9330</font> </td><td> <font color='green'>0.9330</font> </td><td> <font color='green'>0.5754</font> </td><td> <font color='green'>0.9357</font> </td><td> <font color='green'>0.9357</font> </td><td> <font color='green'>0.5754</font> </td><td> <font color='green'>0.5754</font> </td></tr>
<tr><td> sunspider-1.0          </td><td> <font color='green'>0.9506</font> </td><td> <font color='green'>1.0000</font> </td><td> <font color='green'>0.9409</font> </td><td> <font color='green'>0.9505</font> </td><td> <font color='green'>0.9592</font> </td><td> <font color='green'>0.9364</font> </td><td> <font color='green'>0.9409</font> </td><td> <font color='green'>0.9506</font> </td><td> <font color='green'>0.9364</font> </td><td> <font color='green'>0.9458</font> </td></tr>
<tr><td> v8-v6                  </td><td> <font color='green'>0.9466</font> </td><td> <font color='red'>1.0001</font> </td><td> <font color='green'>0.9468</font> </td><td> <font color='green'>0.9461</font> </td><td> <font color='green'>0.9501</font> </td><td> <font color='green'>0.9197</font> </td><td> <font color='green'>0.9469</font> </td><td> <font color='green'>0.9500</font> </td><td> <font color='green'>0.9195</font> </td><td> <font color='green'>0.9220</font> </td></tr>
<tr><td> kraken-1.1             </td><td> <font color='green'>0.9382</font> </td><td> <font color='green'>0.9998</font> </td><td> <font color='green'>0.9356</font> </td><td> <font color='green'>0.9382</font> </td><td> <font color='green'>0.9391</font> </td><td> <font color='green'>0.9307</font> </td><td> <font color='green'>0.9356</font> </td><td> <font color='green'>0.9364</font> </td><td> <font color='green'>0.9307</font> </td><td> <font color='green'>0.9315</font> </td></tr></tbody></table>

<h2>Percentage of additional recompilations</h2>
<table><thead><th> <b>SUITE/BENCHMARK</b> </th><th> <b>PS</b> </th><th> <b>CP</b> </th><th> <b>PS/CP</b> </th><th> <b>PS/DCEC</b> </th><th> <b>PS/LINV</b> </th><th> <b>PS/CP/DCEC</b> </th><th> <b>PS/CP/BCE</b> </th><th> <b>PS/CP/LINV</b> </th><th> <b>PS/CP/DCEC/BCE</b> </th><th> <b>PS/CP/LINV/DCEC/BCE</b> </th></thead><tbody>
<tr><td> facebook-chrome        </td><td> <font color='red'>1.0492</font> </td><td> <font color='green'>1.0000</font> </td><td> <font color='red'>1.0492</font> </td><td> <font color='red'>1.0492</font> </td><td> <font color='red'>1.0492</font> </td><td> <font color='red'>1.0492</font> </td><td> <font color='red'>1.0492</font> </td><td> <font color='red'>1.0492</font> </td><td> <font color='red'>1.0492</font> </td><td> <font color='red'>1.0492</font> </td></tr>
<tr><td> google-firefox         </td><td> <font color='red'>1.0500</font> </td><td> <font color='green'>1.0000</font> </td><td> <font color='red'>1.0500</font> </td><td> <font color='red'>1.0500</font> </td><td> <font color='red'>1.0500</font> </td><td> <font color='red'>1.0500</font> </td><td> <font color='red'>1.0500</font> </td><td> <font color='red'>1.0500</font> </td><td> <font color='red'>1.0500</font> </td><td> <font color='red'>1.0500</font> </td></tr>
<tr><td> twitter-webkit         </td><td> <font color='red'>1.2308</font> </td><td> <font color='green'>1.0000</font> </td><td> <font color='red'>1.2308</font> </td><td> <font color='red'>1.2308</font> </td><td> <font color='red'>1.2308</font> </td><td> <font color='red'>1.2308</font> </td><td> <font color='red'>1.2308</font> </td><td> <font color='red'>1.2308</font> </td><td> <font color='red'>1.2308</font> </td><td> <font color='red'>1.2308</font> </td></tr>
<tr><td> yahoo-firefox          </td><td> <font color='red'>1.1000</font> </td><td> <font color='green'>1.0000</font> </td><td> <font color='red'>1.1000</font> </td><td> <font color='red'>1.1000</font> </td><td> <font color='red'>1.1000</font> </td><td> <font color='red'>1.1000</font> </td><td> <font color='red'>1.1000</font> </td><td> <font color='red'>1.1000</font> </td><td> <font color='red'>1.1000</font> </td><td> <font color='red'>1.1000</font> </td></tr>
<tr><td> sunspider-1.0          </td><td> <font color='red'>1.0311</font> </td><td> <font color='green'>1.0000</font> </td><td> <font color='red'>1.0356</font> </td><td> <font color='red'>1.0311</font> </td><td> <font color='red'>1.0133</font> </td><td> <font color='red'>1.0311</font> </td><td> <font color='red'>1.0356</font> </td><td> <font color='red'>1.0178</font> </td><td> <font color='red'>1.0311</font> </td><td> <font color='red'>1.0133</font> </td></tr>
<tr><td> v8-v6                  </td><td> <font color='red'>1.0629</font> </td><td> <font color='green'>1.0000</font> </td><td> <font color='red'>1.0583</font> </td><td> <font color='red'>1.0606</font> </td><td> <font color='red'>1.0536</font> </td><td> <font color='red'>1.0606</font> </td><td> <font color='red'>1.0629</font> </td><td> <font color='red'>1.0536</font> </td><td> <font color='red'>1.0606</font> </td><td> <font color='red'>1.0513</font> </td></tr>
<tr><td> kraken-1.1             </td><td> <font color='red'>1.0335</font> </td><td> <font color='green'>1.0000</font> </td><td> <font color='red'>1.0335</font> </td><td> <font color='red'>1.0335</font> </td><td> <font color='red'>1.0335</font> </td><td> <font color='red'>1.0335</font> </td><td> <font color='red'>1.0335</font> </td><td> <font color='red'>1.0335</font> </td><td> <font color='red'>1.0335</font> </td><td> <font color='red'>1.0335</font> </td></tr></tbody></table>

<h2>Number of deoptimizations</h2>
<table><thead><th> <b>SUITE/BENCHMARK</b> </th><th> <b>PS</b> </th><th> <b>CP</b> </th><th> <b>PS/CP</b> </th><th> <b>PS/DCEC</b> </th><th> <b>PS/LINV</b> </th><th> <b>PS/CP/DCEC</b> </th><th> <b>PS/CP/BCE</b> </th><th> <b>PS/CP/LINV</b> </th><th> <b>PS/CP/DCEC/BCE</b> </th><th> <b>PS/CP/LINV/DCEC/BCE</b> </th></thead><tbody>
<tr><td> facebook-chrome        </td><td> <font color='red'>3</font> </td><td> <font color='blue'>0</font> </td><td> <font color='red'>3</font> </td><td> <font color='red'>3</font> </td><td> <font color='red'>3</font> </td><td> <font color='red'>3</font> </td><td> <font color='red'>3</font> </td><td> <font color='red'>3</font> </td><td> <font color='red'>3</font> </td><td> <font color='red'>3</font> </td></tr>
<tr><td> google-firefox         </td><td> <font color='red'>4</font> </td><td> <font color='blue'>0</font> </td><td> <font color='red'>4</font> </td><td> <font color='red'>4</font> </td><td> <font color='red'>4</font> </td><td> <font color='red'>4</font> </td><td> <font color='red'>4</font> </td><td> <font color='red'>4</font> </td><td> <font color='red'>4</font> </td><td> <font color='red'>4</font> </td></tr>
<tr><td> twitter-webkit         </td><td> <font color='red'>3</font> </td><td> <font color='blue'>0</font> </td><td> <font color='red'>3</font> </td><td> <font color='red'>3</font> </td><td> <font color='red'>3</font> </td><td> <font color='red'>3</font> </td><td> <font color='red'>3</font> </td><td> <font color='red'>3</font> </td><td> <font color='red'>3</font> </td><td> <font color='red'>3</font> </td></tr>
<tr><td> yahoo-firefox          </td><td> <font color='red'>1</font> </td><td> <font color='blue'>0</font> </td><td> <font color='red'>1</font> </td><td> <font color='red'>1</font> </td><td> <font color='red'>1</font> </td><td> <font color='red'>1</font> </td><td> <font color='red'>1</font> </td><td> <font color='red'>1</font> </td><td> <font color='red'>1</font> </td><td> <font color='red'>1</font> </td></tr>
<tr><td> sunspider-1.0          </td><td> <font color='red'>33</font> </td><td> <font color='blue'>0</font> </td><td> <font color='red'>33</font> </td><td> <font color='red'>33</font> </td><td> <font color='red'>33</font> </td><td> <font color='red'>33</font> </td><td> <font color='red'>33</font> </td><td> <font color='red'>33</font> </td><td> <font color='red'>33</font> </td><td> <font color='red'>33</font> </td></tr>
<tr><td> v8-v6                  </td><td> <font color='red'>39</font> </td><td> <font color='blue'>0</font> </td><td> <font color='red'>38</font> </td><td> <font color='red'>39</font> </td><td> <font color='red'>39</font> </td><td> <font color='red'>39</font> </td><td> <font color='red'>39</font> </td><td> <font color='red'>39</font> </td><td> <font color='red'>39</font> </td><td> <font color='red'>38</font> </td></tr>
<tr><td> kraken-1.1             </td><td> <font color='red'>27</font> </td><td> <font color='blue'>0</font> </td><td> <font color='red'>27</font> </td><td> <font color='red'>27</font> </td><td> <font color='red'>27</font> </td><td> <font color='red'>27</font> </td><td> <font color='red'>27</font> </td><td> <font color='red'>27</font> </td><td> <font color='red'>27</font> </td><td> <font color='red'>27</font> </td></tr>